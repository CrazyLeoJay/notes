# Android 手游 SDK 及其相关服务开发

记录如何从 0~1 搭建手游 SDK 和自动化打包服务。

## 业务

先聊业务实现，后续架构需要根据业务实际情况去设计。

买量公司跟游戏公司合作，游戏接入买量公司的 SDK，然后由买量公司的系统构建适配各个投放渠道的 Apk 包，有些需要配合美术资源形成的广告，就成为了我们看到的游戏广告。

接下来通过分析盈利模式，在后续代码设计时会用到。

**盈利模式**（可能不准确）：当用户点击广告下载游戏后，产生的下载、安装、激活、注册、登录、注册角色、付费，用户游玩等行为，这些行为会被游戏、买量公司和三方平台收集，根据用户的付费总额，会有至少三方进行收益分成。

其中游戏和买量公司的合作方式又有发行、聚合之分。（这里的层数，是指经手的不同公司平台，包括游戏主体和三方独立的 sdk）

**发行**：可能是（应该是）独家代理投放，代码结构会比较简单，层数大多数只有三到四成

**聚合**：买量公司的上游游戏，是其他的发行买量公司，这样会设计到多层嵌套。

常规情况下，如果公司有发行聚合实力，则会设计为三个平台，主要为手游 sdk 和发行聚合 sdk。分属于不同资质，可以理解为同一公司主体下的子公司

**手游 SDK**：提供主要的功能，是核心中核心，不论何时都会用到。

**发行 SDK**和**聚合 SDK**：主要采集相关数据，不提供实际可见的功能，需要接入手游 sdk 或者三方有登录注册功能的 SDK。具体方式需要看公司的合作模式。有时候需要保留用户系统，会接入自己平台的 sdk 然后再接入三方带有登录注册功能的 SDK。

## 手游 SDK

手游 SDK 主要服务于手游买量相关。

主要服务的上游有：游戏公司、聚合发行买量公司。

主要投放的下游有：广告平台、手机应用平台，其他三方应用市场平台、视频平台等可以投放 apk 的地方。

sdk 开发主要提供：账户、支付和三方 SDK 接入。

次要功能：悬浮球、活动、激励广告等



## （可选）发行、聚合 SDK

根据公司业务需求，直接对接游戏，需要打包对外投放的 SDK。

## （核心）apk 反编译构建脚本

在游戏接入 sdk 后，通过脚本实现：

- 更新 sdk 代码
- 写入三方 sdk 代码
- 修复 bug

## 自动打包系统

主要需要实现的功能有：

- 设计构建脚本任务
- 设计不同平台的参数系统
- 设计不同平台的交付
- 设计资源的提供、获取和自动化流转

可以进行的优化设计

- 合理规划构建任务，尽可能的不浪费系统资源。
- 优化参数系统，和各个平台联动获取。
- 设计分布式打包，通过以空间换时间的方式，使用多台设备，进一步提升打包效率
- 配置代码 CICD，代码提交后自动构建资源 apk，并且动态预生成不同渠道的资源。

## 其他业务（不是很重要，后续可能会有一点涉及）

一般情况下，公司还会有**大数据**、**广告**等平台，

**大数据**：采集用户产生的行为，进行用户分析，建立模型，给出投放建议，

**广告**：这个平台主要提供给业务部门使用，业务部门的员工可以通过平台，

- 获取渠道包去不同平台投放，
- 直接投放到某个平台。
- 可以看到投放后包数据，即投放效果和大数据分析
